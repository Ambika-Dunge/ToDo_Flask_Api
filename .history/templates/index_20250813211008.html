<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>To-Do Pro — Flask API + UI</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="data:,"/>
  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900  */
      --muted:#94a3b8;     /* slate-400 */
      --brand:#8b5cf6;     /* violet-500*/
      --brand-2:#22d3ee;   /* cyan-400   */
      --ok:#10b981;        /* emerald-500 */
      --danger:#ef4444;    /* red-500 */
    }
    html,body{height:100%; background: radial-gradient(1000px 600px at 10% 10%, rgba(139,92,246,.15), transparent 40%), radial-gradient(800px 500px at 90% 10%, rgba(34,211,238,.12), transparent 40%), var(--bg); color:white; font-family:"Poppins",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;}
    .glass{background: rgba(17,24,39,.7); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,.06);}
    .btn{transition: transform .06s ease, box-shadow .2s ease;}
    .btn:active{transform: translateY(1px) scale(.99);}
    .gradient-text{background: linear-gradient(90deg, var(--brand), var(--brand-2)); -webkit-background-clip:text; background-clip:text; color:transparent;}
    .shadow-soft{box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);}
    .chip{background: rgba(255,255,255,.06); padding:.25rem .5rem; border-radius:999px; font-size:.75rem; color:var(--muted);}
    .task-card{border:1px solid rgba(255,255,255,.06);}
    .strike{ text-decoration: line-through; opacity:.6;}
  </style>
</head>
<body>
  <div class="min-h-screen">
    <header class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-10">
      <div class="flex items-center justify-between">
        <h1 class="text-3xl sm:text-4xl font-bold gradient-text">To‑Do Pro</h1>
        <div class="flex items-center gap-2">
          <span class="chip hidden sm:inline">Flask REST API</span>
          <span class="chip hidden sm:inline">JSON Persistence</span>
          <span class="chip">Local-first</span>
        </div>
      </div>
      <p class="text-sm text-slate-300 mt-2">A sleek to‑do app powered by a clean Flask API. Add tasks, set due dates, mark complete—your data survives restarts via <span class="font-semibold">tasks.json</span>.</p>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
      <!-- Add Task Card -->
      <section class="glass shadow-soft rounded-2xl p-5">
        <div class="flex flex-col sm:flex-row gap-3">
          <input id="title" type="text" placeholder="Task title..." class="flex-1 px-4 py-3 rounded-xl bg-black/30 border border-white/10 outline-none focus:border-white/30" />
          <input id="dueDate" type="date" class="px-4 py-3 rounded-xl bg-black/30 border border-white/10 outline-none focus:border-white/30"/>
          <button id="addBtn" class="btn px-5 py-3 rounded-xl bg-violet-600 hover:bg-violet-500 shadow-soft font-semibold">Add Task</button>
        </div>
        <p class="text-xs text-slate-400 mt-2">Tip: Press <kbd class="chip">Enter</kbd> while typing to add quickly.</p>
      </section>

      <!-- Task List -->
      <section class="mt-6 grid gap-3" id="taskList"></section>
    </main>

    <footer class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 text-slate-400 text-sm">
      Built with ❤️ using Flask. API endpoints: <span class="chip">/tasks</span>.
    </footer>
  </div>

  <script>
    const API_BASE = "";
    const list = document.getElementById("taskList");
    const input = document.getElementById("title");
    const dateInput = document.getElementById("dueDate");
    const addBtn = document.getElementById("addBtn");

    async function fetchTasks(){
      const res = await fetch(`${API_BASE}/tasks`);
      const data = await res.json();
      renderTasks(data);
    }

    function fmtDate(d){
      if(!d) return "";
      try { return new Date(d).toLocaleDateString(); } catch(e){ return d; }
    }

    function taskCard(t){
      const done = t.completed ? "strike" : "";
      const due = t.due_date ? `<span class="chip">Due: ${fmtDate(t.due_date)}</span>` : "";
      return `
        <div class="glass task-card rounded-xl p-4 flex items-center justify-between gap-3">
          <div class="flex items-center gap-3">
            <input type="checkbox" ${t.completed ? "checked" : ""} class="size-5 rounded" data-id="${t.id}" data-role="toggle"/>
            <div>
              <div class="font-semibold ${done}">${t.title}</div>
              <div class="text-xs text-slate-400 flex gap-2 mt-1">
                ${due}
                <span class="chip">#${t.id}</span>
              </div>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <button class="btn px-3 py-2 rounded-lg bg-cyan-500/90 hover:bg-cyan-400/90" data-role="edit" data-id="${t.id}">Edit</button>
            <button class="btn px-3 py-2 rounded-lg bg-red-500/90 hover:bg-red-400/90" data-role="delete" data-id="${t.id}">Delete</button>
          </div>
        </div>
      `;
    }

    function renderTasks(tasks){
      if(!tasks.length){
        list.innerHTML = `<div class="text-slate-400 text-center py-10">No tasks yet. Add your first task above!</div>`;
        return;
      }
      list.innerHTML = tasks.map(taskCard).join("");
    }

    async function addTask(){
      const title = input.value.trim();
      if(!title) return;
      const due_date = dateInput.value || null;
      const res = await fetch(`${API_BASE}/tasks`, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({title, due_date})
      });
      if(res.ok){
        input.value = "";
        dateInput.value = "";
        fetchTasks();
      }else{
        const err = await res.json();
        alert(err.message || "Error adding task");
      }
    }

    async function toggleCompleted(id, value){
      const res = await fetch(`${API_BASE}/tasks/${id}`, {
        method: "PUT",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({completed: value})
      });
      if(res.ok){ fetchTasks(); }
    }

    async function editTask(id){
      const res = await fetch(`${API_BASE}/tasks/${id}`);
      if(!res.ok) return;
      const task = await res.json();
      const newTitle = prompt("Edit title:", task.title);
      if(newTitle === null) return;
      const newDue = prompt("Edit due date (YYYY-MM-DD) or leave blank:", task.due_date || "");
      const body = { title: newTitle.trim() };
      if(newDue !== null){
        body.due_date = newDue.trim() || null;
      }
      const up = await fetch(`${API_BASE}/tasks/${id}`, {
        method: "PUT",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(body)
      });
      if(up.ok){ fetchTasks(); }
      else{
        const err = await up.json();
        alert(err.message || "Update failed");
      }
    }

    async function deleteTask(id){
      if(!confirm("Delete this task?")) return;
      const res = await fetch(`${API_BASE}/tasks/${id}`, { method: "DELETE" });
      if(res.status === 204) fetchTasks();
    }

    addBtn.addEventListener("click", addTask);
    input.addEventListener("keydown", (e)=>{ if(e.key === "Enter") addTask(); });

    list.addEventListener("click", (e)=>{
      const t = e.target;
      const role = t.getAttribute("data-role");
      const id = t.getAttribute("data-id");
      if(role === "delete") deleteTask(id);
      if(role === "edit") editTask(id);
    });

    list.addEventListener("change", (e)=>{
      const t = e.target;
      if(t.getAttribute("data-role") === "toggle"){
        const id = t.getAttribute("data-id");
        toggleCompleted(id, t.checked);
      }
    });

    fetchTasks();
  </script>
</body>
</html>
